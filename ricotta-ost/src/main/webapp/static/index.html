<!DOCTYPE html>
<!--
    Copyright 2011, 2012 Ola SandstrÃ¶m.

    This file is part of Ricotta.

    Ricotta is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    Ricotta is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Ricotta.  If not, see <http://www.gnu.org/licenses/>.
-->
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Ricotta</title>
        <link type="text/css" href="css/blitzer/jquery-ui-1.8.17.custom.css" rel="stylesheet" />	
        <link type="text/css" href="ricotta.custom.css" rel="stylesheet" />	
    </head>
    <body>
        <div id="header" class="ui-widget">
            <table id="headerTable" class="ui-widget" width="100%">
                <tfoot>
                    <tr>
                        <td id="toast" colspan="6" style="text-align: center;"></td>
                    </tr>
                </tfoot>
                <tbody  class="ui-widget ui-widget-content" >
                    <tr>
                        <td id="headerHome" class="ui-state-default">Home</td>
                        <td id="headerProject" class="ui-state-default" style="display: none;">Project</td>
                        <td id="headerView" class="ui-state-default" style="display: none;">View</td>
                        <td id="headerContext" class="ui-state-default" style="display: none;">Context</td>
                        <td id="headerLanguage" class="ui-state-default" style="display: none;">Lang</td>
                        <td id="headerUser" style="text-align: right;" class="ui-state-default"><span id="headerUsername"></span> - <a id="headerUserAction" href="" >Login</a></td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <div id="contents" class="ui-widget"></div>
        
        <div id="footer" class="ui-widget">
        </div>
        <div>
            Ricotta translations management tool <a href="/classic/index.html">Classic view</a>
        </div>
        <div>For Ricotta, the GNU General Public License version 3 applies, <a href="/LICENSE">GPLv3</a>.
        </div>
        <script type="text/javascript" src="js/jquery-1.7.1.min.js"></script>
        <script type="text/javascript" src="js/jquery-ui-1.8.17.custom.min.js"></script>
	<script type="text/javascript" src="ricotta_common.js"></script>
        <script type="text/javascript">
$.ajaxSetup( {
    cache: false,
    data: null
});

function showToast(s) {
    $("#toast").text(s).show();
}

function hideToast() {
    $("#toast").text("").hide();
}

$(document).ready(function() {
    showToast("Checking login status...");
    $.ajax({
//        async: false,
        type: "GET",
        url: "/api/me/v10",
        data: {
            path: "/index.html"
        },
        dataType: "json",
        success: function(data){
            $("#headerUser").data("json", data);
            $("#headerUsername").text(data.email);
            $("#headerUserAction").text("Logout");
            $("#headerUserAction").attr("href", data.url);
            hideToast();
            $("#contents").html("Loading...").load("home.html");
        },
        error: function(jqXHR, textStatus, errorThrown) {
            hideToast();
            $("#headerUsername").text("Anonymous");
            $("#headerUserAction").attr("href", jqXHR.getResponseHeader("Login-Logout-URL"));
            $("#contents").html('<img src="/RicottaOverview.2.png" alt="Ricotta Overview" />');
        }
    });        
});

$("#headerHome").click(function() {
    document.location = "index.html";
});
$("#headerProject").click(function() {
    $("#contents").html("Loading...").load("project.html");
});
        </script>
        
    </body>
</html>
